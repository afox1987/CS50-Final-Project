{% load static %}
{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>GDELT API - Articles</title>
     <!-- load stylesheets -->
     <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700">  <!-- Google web font "Open Sans" -->
     <link rel="stylesheet" href="{% static 'assets/font-awesome-4.7.0/css/font-awesome.min.css' %}">                <!-- Font Awesome -->
     <link rel="stylesheet" href="{% static 'assets/css/bootstrap.min.css' %}">                                      <!-- Bootstrap style -->
     <link rel="stylesheet" type="text/css" href="{% static 'assets/slick/slick.css' %}"/>
     <link rel="stylesheet" type="text/css" href="{% static 'assets/slick/slick-theme.css' %}"/>
     <link rel="stylesheet" type="text/css" href="{% static 'assets/css/datepicker.css' %}"/>
     <link rel="stylesheet" href="{% static 'assets/css/tooplate-style.css' %}">    
     <script src="{% static 'assets/js/jquery-1.11.3.min.js' %}"></script>             
<body>
    <style>
        #img_logo
        {
            height: 100px;
            width: 270px;
        }
           .tm-form-element-100
            {
                width: 70% !important;
            }
            .tm-form-element-50
            {
                width: 15% !important;
            }
            .tm-btn-search .tm-form-element-icon
            {
                color: white;
                position: absolute;
                top: 15px;
                left: 17%;
                font-size: 17px;
            }
            .tm-section
            {
                min-height: 250px !important;
            }
        .list-grid-ul li
        {
            display: inline !important;
            width: 20% !important;
            float: left !important;
        }
        .list-grid-ul li img{
            max-width: 100%;
            max-height: 100%;
            padding: 5px;
        }
        .grid-container {
  display: grid;
  grid-template-columns: auto auto auto auto;
  padding: 10px;
  width: 100%;
}
.grid-item {
  background-color: rgba(255, 255, 255, 0.8);
  border:  1px solid rgb(185 170 170 / 80%);
  padding: 20px;
  font-size: 30px;
  text-align: center;
  margin:1%;
}
.grid-item .ccountry,.grid-item .cdate
{
    font-size: 14px;  
    line-height: 22px;
}
.grid-item .urllnk b
{
    font-size: 18px;
    line-height: 2px;
}
.grid-item img{
    width: 100%;
}
    </style>
    <div class="tm-main-content" id="top">
        <div class="tm-top-bar-bg"></div>
        <div class="tm-top-bar" id="tm-top-bar">
            <!-- Top Navbar -->
            <div class="container">
                <div class="row">                    
                    <nav class="navbar navbar-expand-lg narbar-light">
                        <a class="navbar-brand mr-auto" href="#">
                            <img src="{% static 'assets/img/logo.png' %}" alt="Site logo" id="img_logo">
                        </a>
                        <button type="button" id="nav-toggle" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#mainNav" aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div id="mainNav" class="collapse navbar-collapse tm-bg-white">
                            <ul class="navbar-nav ml-auto">
                              <li class="nav-item">
                                <a class="nav-link" id="index" href="{% url 'index' %}">Latest News <span class="sr-only">(current)</span></a>
                              </li>
                              <li class="nav-item">
                                <a class="nav-link" id="mapView" href="{% url 'mapView' %}">Map View</a>
                              </li>
                              <li class="nav-item">
                                <a class="nav-link" id="articleView" href="{% url 'articleView' %}">Article View</a>
                              </li>
                              <li class="nav-item">
                                <a class="nav-link" id="contact" href="{% url 'contact' %}">Contact Us</a>
                              </li>
                            </ul>
                        </div>                            
                    </nav>            
                </div>
            </div>
        </div>
        <div class="tm-section tm-bg-img" id="tm-section-1">  
            <div class="row text-center">
                <div class="col-xs-2 ml-auto mr-auto ie-container-width-fix"></div>
                    <div class="col-xs-8 ml-auto mr-auto ie-container-width-fix">
                    <form  id="map_form" class="tm-search-form tm-section-pad-2">
                        <div class="form-row tm-search-form-row">
                            <div id="1_row" class="form-group tm-form-element tm-form-element-100">
                                <i class="fa fa-map-marker fa-2x tm-form-element-icon"></i>
                                <input name="inputkwrd" type="text" class="form-control" id="inputkwrd" placeholder="Type any keyword..." required value="technology">
                            </div>
                            <div id="2_row" class="form-group tm-form-element tm-form-element-50">
                                <button type="button" class="btn btn-primary tm-btn-search" id="btn_serach">  <i class="fa fa-search fa-2x tm-form-element-icon fa-2x tm-form-element-icon"></i> Search News</button>
                            </div>
                        </div>
                    </form>
                </div>   
                <div class="col-xs-2 ml-auto mr-auto ie-container-width-fix"></div>
            </div>             
        </div>
        
        <div class="tm-section tm-position-relative">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none" class="tm-section-down-arrow">
                <polygon fill="#ee5057" points="0,0  100,0  50,60"></polygon>                   
            </svg> 
            <div class="container tm-pt-5 tm-pb-4">
                <div class="row text-center">
                        <div class="grid-container">
                              
                        </div>
                </div>        
            </div>
        </div>                   
        <footer class="tm-bg-dark-blue">
            <div class="container">
                <div class="row">
                    <p class="col-sm-12 text-center tm-font-light tm-color-white p-4 tm-margin-b-0">
                    Copyright &copy; <span class="tm-current-year">2021</span> Designed by Andrew Fox for Harvard's CS50X
                    
                    - Design: <a rel="nofollow" href="https://www.tooplate.com" class="tm-color-primary tm-font-normal" target="_parent">Tooplate</a></p>        
                </div>
            </div>                
        </footer>
    </div>
    <!-- load JS files -->
		            <!-- jQuery (https://jquery.com/download/) -->
                    <script src="{% static 'assets/js/popper.min.js' %}"></script>                    <!-- https://popper.js.org/ -->       
                    <script src="{% static 'assets/js/bootstrap.min.js' %}"></script>                 <!-- https://getbootstrap.com/ -->
                    <script src="{% static 'assets/js/datepicker.min.js' %}"></script>                <!-- https://github.com/qodesmith/datepicker -->
                    <script src="{% static 'assets/js/jquery.singlePageNav.min.js' %}"></script>      <!-- Single Page Nav (https://github.com/ChrisWojcik/single-page-nav) -->
                    <script src="{% static 'assets/slick/slick.min.js' %}"></script>                  <!-- http://kenwheeler.github.io/slick/ --> 
    <script>
        var JsonData;
        $(document).ready(function(){
           $('.tm-current-year').text(new Date().getFullYear());   
           curreloc = window.location.pathname;
           curreloc = curreloc.replace("/","");
           if(curreloc == "")
           {
           $("#index").addClass("active");
           }
           else if(curreloc == "contact")
           {
            $("#contact").addClass("active");  
           }
           else if(curreloc == "articleView")
           {
            $("#articleView").addClass("active");  
           }
           else if(curreloc == "mapView")
           {
            $("#mapView").addClass("active");  
           }
           else if(curreloc == "index")
           {
            $("#index").addClass("active");  
           }
           keyword = $("input[name=inputkwrd]").val();
           $.ajax({
            type:"GET",
            url: "/getMapView/",
            data: {'keywrd': keyword},
            success: function( data ) 
            {    
                JsonData = data;
                list = '';
                $.each(data.data, function(index, val) {
                    imgurl = '';
                    if((data.data[index].image).length != 0)
                    {
                        imgurl = data.data[index].image;
                    }
                    else{
                        imgurl = '/static/assets/img/placeholder.png'
                    }
                    list += '<div class="grid-item"><div class="thumb"><img src='+imgurl+' alt='+ data.data[index].title+'/></div><div class="data"><div><a href='+ data.data[index].url+' class="urllnk"><b> '+ data.data[index].title+'</b></a></div><div class="cdate">Date: '+ data.data[index].date+'</div><div class="ccountry">Country: '+ data.data[index].sourcecountry+'</div></div></div>';
                });
                console.log(list);
               $(".grid-container").append(list);
            }
        });
        $('#btn_serach').on('click', function() {
                keyword = $("input[name=inputkwrd]").val();
                if(keyword.length != 0)
                {
                    $.ajax({
            type:"GET",
            url: "/getMapView/",
            data: {'keywrd': keyword},
            success: function( data ) 
            {   
                if(data.data[0].url != "")
                {
                JsonData = data;
                list = '';
                $(".grid-container").empty();
                $.each(data.data, function(index, val) {
                    imgurl = '';
                    if((data.data[index].image).length != 0)
                    {
                        imgurl = data.data[index].image;
                    }
                    else{
                        imgurl = '/static/assets/img/placeholder.png'
                    }
                    list += '<div class="grid-item"><div class="thumb"><img src='+imgurl+' alt='+ data.data[index].title+'/></div><div class="data"><div><a href='+ data.data[index].url+' class="urllnk"><b> '+ data.data[index].title+'</b></a></div><div class="cdate">Date: '+ data.data[index].date+'</div><div class="ccountry">Country: '+ data.data[index].sourcecountry+'</div></div></div>';
                });
                console.log(list);
               $(".grid-container").append(list);
            }
            else{
                $(".grid-container").empty();
            alert("No Data");
        }
        }
        });
                }
                else{
                    alert("Please enter a valid keyword");
                }
            });
       });
</script>

</body>
{% endblock %}
